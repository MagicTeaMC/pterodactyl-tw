!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.i18nextMultiloadBackendAdapter=e()}(this,function(){"use strict";function n(n){return o.call(u.call(arguments,1),function(e){if(e)for(var t in e)void 0===n[t]&&(n[t]=e[t])}),n}function e(n){return n?"function"==typeof n?new n:n:null}function t(n,e,t){var a;return function(){var i=this,c=arguments,o=function(){a=null,t||n.apply(i,c)},u=t&&!a;clearTimeout(a),a=setTimeout(o,e),u&&n.apply(i,c)}}function a(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function i(){return{debounceInterval:50}}var c=[],o=c.forEach,u=c.slice,r=function(){function n(n,e){for(var t=0;t<e.length;t++){var a=e[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(n,a.key,a)}}return function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}}(),s=function(){function c(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,c),this.type="backend",this.pending=[],this.init(n,e)}return r(c,[{key:"init",value:function(a){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2];if(this.services=a,this.options=n(c,this.options||{},i()),this.debouncedLoad=t(this.load,this.options.debounceInterval),this.options.backend&&(this.backend=this.backend||e(this.options.backend),this.backend.init(a,this.options.backendOption,o)),this.backend&&!this.backend.readMulti)throw new Error("The wrapped backend does not support the readMulti function.")}},{key:"read",value:function(n,e,t){this.pending.push({language:n,namespace:e,callback:t}),this.debouncedLoad()}},{key:"load",value:function(){if(this.backend&&this.pending.length){var n=this.pending;this.pending=[];var e=n.reduce(function(n,e){return n.languages.indexOf(e.language)<0&&n.languages.push(e.language),n.namespaces.indexOf(e.namespace)<0&&n.namespaces.push(e.namespace),n},{languages:[],namespaces:[]});this.backend.readMulti(e.languages,e.namespaces,function(e,t){if(e)return n.forEach(function(n){return n.callback(e,t)});n.forEach(function(n){var e=t[n.language]&&t[n.language][n.namespace];n.callback(null,e||{})})})}}},{key:"create",value:function(n,e,t,a){this.backend&&this.backend.create&&this.backend.create(n,e,t,a)}}]),c}();return s.type="backend",s});
